define(["jquery","core/log","mod_readseed/definitions"],function(a,b,c){"use strict";return b.debug("Read Seed Quiz helper: initialising"),{controls:{},submitbuttonclass:"mod_readseed_quizsubmitbutton",init:function(a,b,c,d){this.quizdata=b,this.controls.quizcontainer=a,this.attemptid=d,this.cmid=c,this.prepare_html(),this.register_events()},prepare_html:function(){var b=this,d="<span><b>QUESTION @@INDEX@@: @@DATA@@</b></span><br>",e="<span>A: @@DATA@@</span><br>",f="<span><i>A: [ AUDIO RECORDER GOES HERE ] </i></span><br>",g='<button type="button" class="'+this.submitbuttonclass+'">Submit Quiz</button><br>';a.each(this.quizdata,function(a,g){var h=d.replace("@@DATA@@",g.text);switch(h=h.replace("@@INDEX@@",a+1),b.controls.quizcontainer.append(h),g.type){case c.qtype_textpromptaudio:b.controls.quizcontainer.append(f);break;case c.qtype_textpromptlong:case c.qtype_textpromptshort:default:b.controls.quizcontainer.append(e.replace("@@DATA@@",g.answer1)),b.controls.quizcontainer.append(e.replace("@@DATA@@",g.answer2)),b.controls.quizcontainer.append(e.replace("@@DATA@@",g.answer3)),b.controls.quizcontainer.append(e.replace("@@DATA@@",g.answer4))}}),b.controls.quizcontainer.append(g)},register_events:function(){var b=this;a("."+this.submitbuttonclass).on("click",function(){var a={qanswer1:"1",qanswer2:"2",qanswer3:"3",qanswer4:"4",qanswer5:"1",qtextanswer1:"abc"};b.send_quizresults(a)})},send_quizresults:function(c){var d={};d.action="quizresults",d.attemptid=this.attemptid,d.cmid=this.cmid,d.quizresults=JSON.stringify(c);var e=new XMLHttpRequest,f=this;e.onreadystatechange=function(a){4===this.readyState&&(200==e.status?b.debug("ok we got an attempt quiz submission response"):b.debug("NOT GOOD attempt quiz submission  response"),f.onSubmit())},e.open("POST",M.cfg.wwwroot+"/mod/readseed/ajaxhelper.php",!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.setRequestHeader("Cache-Control","no-cache"),e.send(a.param(d))},onSubmit:function(){alert("quiz submitted. Override this")}}});